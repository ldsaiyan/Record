# Weblogic SSRF漏洞 （CVE-2014-4210）

## 介绍
​ SSRF(Server-Side Request Forgery:服务器端请求伪造) 是一种伪造服务器端发起请求的漏洞。一般情况下，可利用漏洞攻击从外网无法访问的内部系统。

SSRF形成的原因大都是由于服务端提供了从其他服务器应用获取数据的功能且没有对目标地址做过滤与限制。

用于扫描内外网开放服务及端口，并进行攻击；利用file、gopher、dict协议读取本地文件、执行命令；用于攻击内外网的web应用，例如直接SQL注入、XSS攻击等；用于DOS攻击（请求大文件，始终保持连接Keep-Alive Always）

## 环境
CentOS7
Vulhub
影响版本 weblogic 10.0.2.0 -- 10.3.6.0

## 漏洞复现
依旧是进入vulhub对应漏洞的目录开启靶场
```
Docker-compose up -d
```
访问 http://your-ip:7001/uddiexplorer/SearchPublicRegistries.jsp

![](https://github.com/saiyanlee/Record/blob/master/Sys/Weblogic/Weblogic%20SSRF%E6%BC%8F%E6%B4%9E%20%EF%BC%88CVE-2014-4210%EF%BC%89/images/1.png)

在输入框随意输入，search一下顺便抓个包

![](https://github.com/saiyanlee/Record/blob/master/Sys/Weblogic/Weblogic%20SSRF%E6%BC%8F%E6%B4%9E%20%EF%BC%88CVE-2014-4210%EF%BC%89/images/2.png)

观察这个operator参数，值是一个url，有理由怀疑存在ssrf

输入一个存在的且开放80端口服务器地址

![](https://github.com/saiyanlee/Record/blob/master/Sys/Weblogic/Weblogic%20SSRF%E6%BC%8F%E6%B4%9E%20%EF%BC%88CVE-2014-4210%EF%BC%89/images/3.png)

接着试下输入一个不存在的端口，将返回but could not connect over HTTP to server的字眼

![](https://github.com/saiyanlee/Record/blob/master/Sys/Weblogic/Weblogic%20SSRF%E6%BC%8F%E6%B4%9E%20%EF%BC%88CVE-2014-4210%EF%BC%89/images/4.png)

说明存在ssrf漏洞

## 漏洞利用一
探测内网存活ip

同样，输入内网的某url测试

![](https://github.com/saiyanlee/Record/blob/master/Sys/Weblogic/Weblogic%20SSRF%E6%BC%8F%E6%B4%9E%20%EF%BC%88CVE-2014-4210%EF%BC%89/images/5.png)

有红线那段报错证明url存在

不存在则是这样

![](https://github.com/saiyanlee/Record/blob/master/Sys/Weblogic/Weblogic%20SSRF%E6%BC%8F%E6%B4%9E%20%EF%BC%88CVE-2014-4210%EF%BC%89/images/6.png)

## 漏洞利用二
攻击redis

暂时不实现

## 防范
升级到官方的最新版本

ssrf防范：
限制返回信息
限制请求常用的端口
对请求地址设置白名单
禁用除http和https外的协议