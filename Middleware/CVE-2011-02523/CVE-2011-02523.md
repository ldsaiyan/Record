## 漏洞介绍
这是著名的VSFTP2.3.4笑脸漏洞，vsftpd-2.3.4版本里存在后门，后门载荷是以 :) 这个笑脸字符拼接在用户名上，端口为6200。虽然这是个老旧的漏洞，但到ZoomEye上找还是能找到，所以emmmm值得学习。

vsftpd-2.3.4所存在的这个恶意后门，首先是由于源码中的str.c文件中加入了无关代码，代码遍历一旦能找到 :) ，就能调用vsf_sysutil_extra()，这个函数位于sysdeputil.c，也是定义这个后门的关键函数。

## 环境部署及复现前戏
靶机：Metasploitable2-Linux （IP：192.168.140.135）
攻击机：Kali （IP：192.168.140.131）

在Kali上用nmap对靶机进行默认扫描并且显示详细版本信息。
![](https://github.com/saiyanlee/Record/blob/master/Sys/CVE-2011-02523/images/1.png)

发现就是vsftpd的对应漏洞版本2.3.4，很有可能存在笑脸漏洞。
但6200端口并未打开，即后门未激活。

## 漏洞复现
#### Nmap
在nmap的脚本中找到对应该漏洞使用的这个脚本：
![](https://github.com/saiyanlee/Record/blob/master/Sys/CVE-2011-02523/images/2.png)

进行漏洞检测
![](https://github.com/saiyanlee/Record/blob/master/Sys/CVE-2011-02523/images/3.png)

确实存在

然后ftp登录激活后门，再用nc进行连接6200端口
![](https://github.com/saiyanlee/Record/blob/master/Sys/CVE-2011-02523/images/9.png)
![](https://github.com/saiyanlee/Record/blob/master/Sys/CVE-2011-02523/images/10.png)

success~

#### Metasploit
找到该漏洞的exploit模块
![](https://github.com/saiyanlee/Record/blob/master/Sys/CVE-2011-02523/images/4.png)

调用该模块，并且查看需要设置的参数
![](https://github.com/saiyanlee/Record/blob/master/Sys/CVE-2011-02523/images/5.png)

设置目标地址
![](https://github.com/saiyanlee/Record/blob/master/Sys/CVE-2011-02523/images/6.png)

exploit一下，发现目标的后门返回来了
![](https://github.com/saiyanlee/Record/blob/master/Sys/CVE-2011-02523/images/7.png)

success~
![](https://github.com/saiyanlee/Record/blob/master/Sys/CVE-2011-02523/images/8.png)
